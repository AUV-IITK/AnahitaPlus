<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AnahitaPlus: hardware_imu</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AnahitaPlus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">hardware_imu </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is a ROS package for interfacing with the <a href="http://px4.io/">PX4</a> hardware or the <a href="https://www.spartonnavex.com/product/ahrs-8/">Sparton AHRS-8</a> hardware.</p>
<p>For the PX4, we are using the in-built inertial measurement unit (IMU) present in the PX4 for the robot. For the Sparton AHRS8, the driver communicates with the sensor using NMEA protocol and publishes the IMU data as ROS sensor messages.</p>
<p>The <code>hardware_imu</code> package has been tested under <a href="http://www.ros.org">ROS</a> Kinetic and Ubuntu 16.04 LTS. The source code is released under a BSD 3-Clause license.</p>
<ul>
<li><a href="http://wiki.ros.org">Robot Operating System (ROS)</a> (middleware for robotics),</li>
<li>Following ROS Packages: <a href="http://wiki.ros.org/mavros">mavros</a>, <a href="http://wiki.ros.org/mavros_extras">mavros_extras</a></li>
</ul>
<p>According to the installation instructions present <a href="https://github.com/mavlink/mavros/blob/master/mavros/README.md#binary-installation-deb">here</a>, run the following commands to install GeographicLib datasets which is required as a mavros dependency: </p><div class="fragment"><div class="line">wget https://raw.githubusercontent.com/mavlink/mavros/master/mavros/scripts/install_geographiclib_datasets.sh</div><div class="line">./install_geographiclib_datasets.sh</div></div><!-- fragment --><p>Download <a href="https://docs.qgroundcontrol.com/en/getting_started/download_and_install.html">QGround Control</a> and run it with PIXHAWK attached with your computer. Read the manual <a href="https://docs.qgroundcontrol.com/en/SetupView/Sensors.html">here</a> for further instructions.</p>
<p>Run the following command from the root of your catkin workspace: </p><div class="fragment"><div class="line">catkin_make --pkg hardware_imu</div></div><!-- fragment --><p>To run the <b>PIXHAWK IMU</b>: </p><div class="fragment"><div class="line">roslaunch hardware_imu imu_px4.launch</div></div><!-- fragment --><p> where the PIXHAWK is assumed to be connected at the <code>/dev/ttyACM0</code> port.</p>
<p>To run the <b>Sparton AHRS8 IMU</b>:</p>
<ol type="1">
<li>Check the serial port to which the sensor is connected at and change the device path in the <a href="launch/ahrs-8.launch">launch file</a> <div class="fragment"><div class="line"># to verify if device is at /dev/ttyUSB0, run:</div><div class="line">udevadm info -a -p  $(udevadm info -q path -n /dev/ttyUSB0)</div></div><!-- fragment --></li>
<li>Ensure that python cript has executable permission: <div class="fragment"><div class="line">chmod +x sparton_ahrs8_driver/scripts/ahrs8_nmea.py</div></div><!-- fragment --></li>
<li>Run the launch file: <div class="fragment"><div class="line">roslaunch sparton_ahrs8_driver ahrs-8.launch</div></div><!-- fragment --></li>
</ol>
<p>The <code>mavros_node</code> is the main communication node for the MAVLink communication protocol used in the PX4 autopilot. The node belongs to the <a href="http://wiki.ros.org/mavros">mavros</a> package.</p>
<ul>
<li>**<code>~imu/data</code>** (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/Imu.html">sensor_msgs/Imu</a>) Imu data, orientation computed by FCU</li>
<li>**<code>~imu/data_raw</code>** (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/Imu.html">sensor_msgs/Imu</a>) Raw IMU data without orientation</li>
<li>**<code>~imu/mag</code>** (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/MagneticField.html">sensor_msgs/MagneticField</a>) FCU compass data</li>
<li>**<code>~imu/temperature</code>** (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/Temperature.html">sensor_msgs/Temperature</a>) Temperature reported by FCU (usually from barometer)</li>
<li>**<code>~imu/atm_pressure</code>** (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/FluidPressure.html">sensor_msgs/FluidPressure</a>) Air pressure.</li>
</ul>
<ul>
<li>**<code>~imu/frame_id</code>** (string, default: fcu) Frame ID for this plugin.</li>
<li>**<code>~imu/linear_acceleration_stdev</code>** (double, default: 0.0003) Gyro's standard deviation</li>
<li>**<code>~imu/angular_velocity_stdev</code>** (double, default: !dec 0.02) Accel's standard deviation</li>
<li>**<code>~imu/orientation_stdev</code>** (double, default: 1.0) Standard deviation for IMU.orientation</li>
<li>**<code>~imu/magnetic_stdev</code>** (double, default: 0.0) Standard deviation for magnetic field message (undefined if: 0.0)</li>
</ul>
<p>This node takes the IMU data in quateranion format and convert it into euler angles. We calculate the roll, pitch and yaw using the following formulas:</p>
<div class="fragment"><div class="line">yaw = atan2 ( 2 * x * y - 2 * w * z, 2 * w * w + 2 * x * x - 1)</div><div class="line">roll = atan2(2 * q2 * q3 - 2 * q0 * q1, 2 * q0 * q0 + 2 * q3 * q3 - 1)</div><div class="line">pitch = -asin(2 * q1 * q3 + 2 * q0 * q2)</div></div><!-- fragment --><p> where <code>q = (w, x, y, z)</code> is the quaternion angle.</p>
<ul>
<li>**<code>~/mavros/imu/data</code>** (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/Imu.html">sensor_msgs/Imu</a>) Imu data, orientation computed by FCU</li>
</ul>
<ul>
<li>**<code>/mavros/imu/yaw</code>** (<a href="http://docs.ros.org/lunar/api/std_msgs/html/msg/Float64.html">std_msgs/Float64</a>) Yaw data computed using quaternion to euler angles transformation **<code>/mavros/imu/pitch</code>** (<a href="http://docs.ros.org/lunar/api/std_msgs/html/msg/Float64.html">std_msgs/Float64</a>) Pitch data computed using quaternion to euler angles transformation **<code>/mavros/imu/roll</code>** (<a href="http://docs.ros.org/lunar/api/std_msgs/html/msg/Float64.html">std_msgs/Float64</a>) Roll data computed using quaternion to euler angles transformation</li>
</ul>
<p>The node communicate with the sensor using the NMEA protocol and publishes IMU data.</p>
<ul>
<li>**<code>~frame_id</code>** (string, default: <code>ahrs8_imu</code>) Frame ID for this plugin</li>
<li>**<code>~port</code>** (string, default: <code>/dev/ttyUSB0</code>) Port at which sensor is connected</li>
<li>**<code>~baud</code>** (double, default: <code>115200</code>) Baud rate for communication with the sensor</li>
</ul>
<ul>
<li>**<code>~imu/data</code>** (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/Imu.html">sensor_msgs/Imu</a>) IMU orientation data, orientation in the <code>ahrs8_imu</code> frame</li>
</ul>
<p>This node takes the IMU data in quateranion format and convert it into euler angles. We calculate the roll, pitch and yaw using the above formulas again</p>
<ul>
<li>**<code>~/sparton/imu/data</code>** (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/Imu.html">sensor_msgs/Imu</a>) Imu data, orientation computed by FCU</li>
</ul>
<ul>
<li>**<code>/sparton/imu/yaw</code>** (<a href="http://docs.ros.org/lunar/api/std_msgs/html/msg/Float64.html">std_msgs/Float64</a>) Yaw data computed using quaternion to euler angles transformation **<code>/sparton/imu/pitch</code>** (<a href="http://docs.ros.org/lunar/api/std_msgs/html/msg/Float64.html">std_msgs/Float64</a>) Pitch data computed using quaternion to euler angles transformation **<code>/sparton/imu/roll</code>** (<a href="http://docs.ros.org/lunar/api/std_msgs/html/msg/Float64.html">std_msgs/Float64</a>) Roll data computed using quaternion to euler angles transformation</li>
</ul>
<p>Please report bugs and request features using the <a href="https://github.com/AUV-IITK/fourtran/issues">Issue Tracker</a>. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
